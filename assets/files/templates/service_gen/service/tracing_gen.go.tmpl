// THIS FILE IS AUTOGENERATED BY kitgen DO NOT EDIT OR CHANGES WILL BE LOST
package service

import (
	"context"

	zipkin "github.com/openzipkin/zipkin-go"
)

type tracingMiddleware struct {
	next {{.Name}}Service
}

// TracingMiddleware returns a {{.Name}}Service Middleware.
func TracingMiddleware() Middleware {
	return func(next {{.Name}}Service) {{.Name}}Service {
		return &tracingMiddleware{next}
	}
}
{{ range .Methods }}
func (t tracingMiddleware) {{.Name}}({{$s := separator ", "}}{{ range $key, $value := .Parameters }}{{call $s}}{{lower $value.Name}} {{$value.Type}}{{end}}) ({{$s := separator ", "}}{{ range $key, $value := .Results }}{{call $s}}{{lower $value.Name}} {{$value.Type}}{{end}}) {
	// retrieve span from context (created by zipkin server middleware)
	span := zipkin.SpanFromContext(ctx)
	span.SetName("{{.Name}}")
	defer span.Finish()

	return t.next.{{.Name}}({{$s := separator ", "}}{{ range $key, $value := .Parameters }}{{call $s}}{{lower $value.Name}}{{end}})
}
{{end}}